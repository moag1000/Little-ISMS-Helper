{% extends 'base.html.twig' %}

{% block title %}Reports & Exports - {{ parent() }}{% endblock %}

{% block body %}
{% import '_macros/cards.html.twig' as cards %}

<div class="container-fluid py-4">
    <h1 class="h2 mb-4">
        <i class="bi bi-file-earmark-bar-graph" aria-hidden="true"></i> Reports & Exports
    </h1>

    <div class="alert alert-info mb-4">
        <i class="bi bi-info-circle" aria-hidden="true"></i> Generate comprehensive reports in PDF or Excel format for compliance documentation and management reviews.
    </div>

    <div class="row">
        {# Dashboard Report #}
        <div class="col-md-6 col-lg-4 mb-4">
            {{ cards.report_card(
                'Dashboard Summary',
                'speedometer2',
                'bg-primary',
                'text-white',
                'Comprehensive ISMS overview with all key metrics and statistics.',
                [
                    'Assets & Risks Overview',
                    'Control Implementation Status',
                    'Incident Summary',
                    'Compliance Percentage'
                ],
                path('app_reports_dashboard_pdf'),
                path('app_reports_dashboard_excel')
            ) }}
        </div>

        {# Risk Register #}
        <div class="col-md-6 col-lg-4 mb-4">
            {{ cards.report_card(
                'Risk Register',
                'exclamation-triangle',
                'bg-danger',
                'text-white',
                'Complete risk assessment documentation with likelihood, impact, and treatment plans.',
                [
                    'All identified risks',
                    'Risk scores & levels',
                    'Treatment strategies',
                    'Risk owners'
                ],
                path('app_reports_risks_pdf'),
                path('app_reports_risks_excel')
            ) }}
        </div>

        {# Statement of Applicability #}
        <div class="col-md-6 col-lg-4 mb-4">
            {{ cards.report_card(
                'Statement of Applicability',
                'shield-check',
                'bg-success',
                'text-white',
                'ISO 27001 Annex A controls documentation with applicability justification.',
                [
                    'All 93 ISO 27001:2022 controls',
                    'Applicability status',
                    'Implementation progress',
                    'Justifications'
                ],
                path('app_reports_controls_pdf'),
                path('app_reports_controls_excel')
            ) }}
        </div>

        {# Incident Log #}
        <div class="col-md-6 col-lg-4 mb-4">
            {{ cards.report_card(
                'Incident Log',
                'bell',
                'bg-warning',
                'text-dark',
                'Complete incident management records with timeline and resolutions.',
                [
                    'All security incidents',
                    'Severity classifications',
                    'Response timelines',
                    'Resolution status'
                ],
                path('app_reports_incidents_pdf'),
                path('app_reports_incidents_excel')
            ) }}
        </div>

        {# Training Log #}
        <div class="col-md-6 col-lg-4 mb-4">
            {{ cards.report_card(
                'Training Log',
                'mortarboard',
                'bg-info',
                'text-white',
                'Security awareness and training documentation with attendance records.',
                [
                    'All conducted trainings',
                    'Participant lists',
                    'Training types & methods',
                    'Mandatory trainings'
                ],
                path('app_reports_trainings_pdf'),
                path('app_reports_trainings_excel')
            ) }}
        </div>

        {# Custom Reports (Coming Soon) #}
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm border-secondary" style="opacity: 0.7;">
                <div class="card-header bg-secondary text-white">
                    <h3 class="mb-0"><i class="bi bi-file-earmark-plus" aria-hidden="true"></i> Custom Reports</h3>
                </div>
                <div class="card-body">
                    <p class="text-muted">Additional custom reports coming soon:</p>
                    <ul class="small mb-3">
                        <li>Audit Summary Reports</li>
                        <li>Management Review Reports</li>
                        <li>Asset Inventory</li>
                        <li>Compliance Gap Analysis</li>
                    </ul>
                </div>
                <div class="card-footer bg-light">
                    <div class="d-grid">
                        <button class="btn btn-sm btn-outline-secondary" disabled>
                            <i class="bi bi-hourglass-split" aria-hidden="true"></i> Coming Soon
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# Best Practices Section #}
    <div class="row mt-4">
        <div class="col-12">
            {% set best_practices_content %}
                <div class="row">
                    <div class="col-md-6">
                        <h4>For Audits & Compliance:</h4>
                        <ul class="small">
                            <li>Generate Statement of Applicability before audits</li>
                            <li>Include Risk Register in management reviews</li>
                            <li>Document incident trends over time</li>
                            <li>Track training completion rates</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h4>For Management Reporting:</h4>
                        <ul class="small">
                            <li>Use Dashboard Summary for executive overviews</li>
                            <li>Highlight high-risk items from Risk Register</li>
                            <li>Show control implementation progress</li>
                            <li>Report on mandatory training completion</li>
                        </ul>
                    </div>
                </div>
            {% endset %}
            {{ cards.simple_card('Best Practices for Reports', 'lightbulb', best_practices_content, null, 'bg-light') }}
        </div>
    </div>
</div>
{% endblock %}
