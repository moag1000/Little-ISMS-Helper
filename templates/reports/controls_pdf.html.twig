<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% trans_default_domain 'soa' %}{{ 'soa.page.title'|trans({}, 'soa') }}</title>
    <style>
        @page { size: A4 landscape; margin: 15mm; }
        body { font-family: 'DejaVu Sans', sans-serif; font-size: 9pt; }
        .header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid transparent;
            border-image: linear-gradient(90deg, #06b6d4 0%, #ec4899 50%, #8b5cf6 100%) 1;
            padding-bottom: 8px;
        }
        .header h1 {
            color: #0f172a;
            margin: 0;
            font-size: 18pt;
            text-transform: uppercase;
            letter-spacing: 0.5pt;
        }
        .header .subtitle { color: #666; font-size: 9pt; margin-top: 5px; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th {
            background: linear-gradient(90deg, #0f172a 0%, #1e293b 100%);
            color: #06b6d4;
            padding: 6px 4px;
            text-align: left;
            font-size: 8pt;
            border: 1px solid #1e3a8a;
            text-transform: uppercase;
            letter-spacing: 0.3pt;
        }
        td { padding: 6px 4px; border: 1px solid #ddd; font-size: 8pt; }
        tr:nth-child(even) { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); }
        .applicable { color: #10b981; font-weight: bold; }
        .not-applicable { color: #dc2626; }
        .progress-bar { background: #e5e7eb; height: 12px; border-radius: 3px; position: relative; }
        .progress-fill {
            background: linear-gradient(90deg, #06b6d4 0%, #0891b2 100%);
            height: 100%;
            border-radius: 3px;
        }
        .footer { position: fixed; bottom: 10px; left: 0; right: 0; text-align: center; font-size: 7pt; color: #666; }

        /* Column widths */
        .w-8 { width: 8%; }
        .w-10 { width: 10%; }
        .w-12 { width: 12%; }
        .w-18 { width: 18%; }
        .w-22 { width: 22%; }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ 'soa.page.title'|trans({}, 'soa') }}</h1>
        <div class="subtitle">ISO/IEC 27001:2022 Annex A Controls | {{ 'soa.report.generated_at'|trans({'%datetime%': generated_at|date('d.m.Y H:i')}, 'soa') }}</div>
    </div>

    <table>
        <thead>
            <tr>
                <th scope="col" class="w-8">{{ 'soa.table.control_id'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-22">{{ 'soa.table.name'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-10">{{ 'soa.table.category'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-12">{{ 'soa.table.applicable'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-12">{{ 'soa.table.implementation_status'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-8">{{ 'soa.table.progress'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-18">{{ 'soa.table.justification'|trans({}, 'soa') }}</th>
                <th scope="col" class="w-10">{{ 'soa.table.target_date'|trans({}, 'soa') }}</th>
            </tr>
        </thead>
        <tbody>
            {% for control in controls %}
            <tr>
                <td>{{ control.controlId }}</td>
                <td>{{ control.name|slice(0, 40) }}{% if control.name|length > 40 %}...{% endif %}</td>
                <td>{{ ('soa.category.' ~ control.category)|trans|default(control.category) }}</td>
                <td class="{% if control.applicability == 'applicable' %}applicable{% else %}not-applicable{% endif %}">
                    {{ control.applicability == 'applicable' ? ('soa.value.yes'|trans({}, 'soa')) : ('soa.value.no'|trans({}, 'soa')) }}
                </td>
                <td>{{ ('soa.status.' ~ control.implementationStatus)|trans|default(control.implementationStatus) }}</td>
                <td>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ control.implementationProgress }}%;"></div>
                    </div>
                    {{ control.implementationProgress }}%
                </td>
                <td>{{ control.justification|slice(0, 35)|default('-') }}{% if control.justification|length > 35 %}...{% endif %}</td>
                <td>{{ control.targetDate ? control.targetDate|date('Y-m-d') : '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="footer">
        <p>{{ 'soa.footer.note'|trans({}, 'soa') }}</p>
    </div>
</body>
</html>
