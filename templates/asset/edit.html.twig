{% extends 'base.html.twig' %}
{% trans_default_domain 'assets' %}

{% block title %}{{ 'asset.title.edit'|trans({}, 'asset') }} - {{ parent() }}{% endblock %}

{% block body %}
{# Breadcrumb Navigation #}
{% include '_components/_breadcrumb.html.twig' with {
    breadcrumbs: [
        { label: 'nav.assets'|trans({}, 'nav', 'nav'), url: path('app_asset_index'), icon: 'bi-cpu' },
        { label: asset.name, url: path('app_asset_show', {id: asset.id}) },
        { label: 'asset.title.edit'|trans({}, 'asset') }
    ]
} %}

{# Page Header #}
{% include '_components/_page_header.html.twig' with {
    title: 'asset.title.edit'|trans({}, 'asset') ~ ': ' ~ asset.name,
    icon: 'bi-pencil',
    actions: [
        { label: 'common.back'|trans({}, 'messages'), url: path('app_asset_show', {id: asset.id}), variant: 'secondary', icon: 'bi-arrow-left' }
    ]
} %}

{% embed '_components/_card.html.twig' %}
    {% block card_body %}
        {{ form_start(form) }}
            {% include '_components/_auto_form.html.twig' with {
                'form': form,
                'sections': {
                    'basic_info': {
                        'label': 'asset.section.basic_info'|trans({}, 'asset'),
                        'fields': ['name', 'assetType', 'description']
                    },
                    'assignment': {
                        'label': 'asset.section.assignment'|trans({}, 'asset'),
                        'fields': ['owner', 'location']
                    },
                    'financial': {
                        'label': 'asset.section.financial'|trans({}, 'asset'),
                        'fields': ['acquisitionValue', 'currentValue', 'monetaryValue']
                    },
                    'classification': {
                        'label': 'asset.section.classification'|trans({}, 'asset'),
                        'fields': ['dataClassification', 'status', 'returnDate']
                    },
                    'cia_values': {
                        'label': 'asset.section.cia_values'|trans({}, 'asset'),
                        'fields': ['confidentialityValue', 'integrityValue', 'availabilityValue']
                    },
                    'policies': {
                        'label': 'asset.section.policies'|trans({}, 'asset'),
                        'fields': ['acceptableUsePolicy', 'handlingInstructions']
                    }
                },
                'col_widths': {
                    'name': 6,
                    'assetType': 6,
                    'description': 12,
                    'owner': 6,
                    'location': 6,
                    'acquisitionValue': 4,
                    'currentValue': 4,
                    'monetaryValue': 4,
                    'dataClassification': 4,
                    'status': 4,
                    'returnDate': 4,
                    'confidentialityValue': 4,
                    'integrityValue': 4,
                    'availabilityValue': 4,
                    'acceptableUsePolicy': 12,
                    'handlingInstructions': 12
                },
                'tooltips': {
                    'acquisitionValue': 'asset.tooltip.acquisition_value',
                    'currentValue': 'asset.tooltip.current_value',
                    'monetaryValue': 'asset.tooltip.monetary_value',
                    'confidentialityValue': 'asset.tooltip.confidentiality',
                    'integrityValue': 'asset.tooltip.integrity',
                    'availabilityValue': 'asset.tooltip.availability'
                },
                'translation_domain': 'asset'
            } %}

            <div class="form-actions d-flex gap-2 justify-content-end">
                <a href="{{ path('app_asset_show', {id: asset.id}) }}" class="btn btn-secondary">
                    <i class="bi bi-x-circle" aria-hidden="true"></i>
                    {{ 'common.cancel'|trans({}, 'messages') }}
                </a>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle" aria-hidden="true"></i>
                    {{ 'asset.action.update'|trans({}, 'asset') }}
                </button>
            </div>
        {{ form_end(form) }}
    {% endblock %}
{% endembed %}

{# Delete Danger Zone (only for edit) #}
{% embed '_components/_card.html.twig' with {borderColor: 'danger', class: 'mt-4'} %}
    {% block card_header %}
        <div class="card-header bg-danger text-white">
            <h2 class="h5 mb-0">
                <i class="bi bi-exclamation-triangle" aria-hidden="true"></i>
                {{ 'common.danger_zone'|trans({}, 'messages') }}
            </h2>
        </div>
    {% endblock %}
    {% block card_body %}
        <p class="text-muted">
            {{ 'asset.warning.delete_irreversible'|trans({}, 'asset') }}
        </p>
        {{ include('asset/_delete_form.html.twig') }}
    {% endblock %}
{% endembed %}
{% endblock %}
