<!DOCTYPE html>
<html lang="{{ app.request.locale }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="turbo-cache-control" content="no-preview">
    <title>{% block title %}{{ 'app.title'|trans }}{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸ”’</text></svg>">

    {% block stylesheets %}
        <link rel="stylesheet" href="{{ asset('styles/app.css') }}">
        <link rel="stylesheet" href="{{ asset('styles/components.css') }}">
        <style>
            /* Turbo Progress Bar */
            .turbo-progress-bar {
                position: fixed;
                display: block;
                top: 0;
                left: 0;
                height: 3px;
                background: #0d6efd;
                z-index: 2147483647;
                transition: width 300ms ease-out, opacity 150ms 150ms ease-in;
                transform: translate3d(0, 0, 0);
            }

            /* Loading state for body */
            body.turbo-loading {
                cursor: wait;
            }

            body.turbo-loading * {
                pointer-events: none;
            }

            /* Alert auto-fade */
            #notifications .alert {
                transition: opacity 0.15s linear;
            }

            #notifications .alert.fade:not(.show) {
                opacity: 0;
            }
        </style>
    {% endblock %}
</head>
<body data-turbo="true">
    <header class="header">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h1>{{ 'app.title'|trans }}</h1>
                <p>{{ 'app.subtitle'|trans }}</p>
            </div>
            <div class="language-switcher">
                <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({'_locale': 'de'})) }}"
                   class="lang-btn {% if app.request.locale == 'de' %}active{% endif %}">DE</a>
                <a href="{{ path(app.request.attributes.get('_route'), app.request.attributes.get('_route_params')|merge({'_locale': 'en'})) }}"
                   class="lang-btn {% if app.request.locale == 'en' %}active{% endif %}">EN</a>
            </div>
        </div>
    </header>

    <nav class="nav" data-turbo-permanent>
        <ul>
            <li><a href="{{ path('app_home') }}" data-turbo-action="advance">{{ 'nav.home'|trans }}</a></li>
            <li><a href="{{ path('app_dashboard') }}" data-turbo-action="advance">{{ 'nav.dashboard'|trans }}</a></li>
            <li><a href="{{ path('app_context_index') }}" data-turbo-action="advance">{{ 'nav.context'|trans }}</a></li>
            <li><a href="{{ path('app_soa_index') }}" data-turbo-action="advance">SoA</a></li>
            <li><a href="{{ path('app_asset_index') }}" data-turbo-action="advance">{{ 'nav.assets'|trans }}</a></li>
            <li><a href="{{ path('app_risk_index') }}" data-turbo-action="advance">{{ 'nav.risks'|trans }}</a></li>
            <li><a href="{{ path('app_business_process_index') }}" data-turbo-action="advance">BCM</a></li>
            <li><a href="{{ path('app_incident_index') }}" data-turbo-action="advance">{{ 'nav.incidents'|trans }}</a></li>
            <li><a href="{{ path('app_audit_index') }}" data-turbo-action="advance">{{ 'nav.audits'|trans }}</a></li>
            <li><a href="{{ path('app_compliance_index') }}" data-turbo-action="advance">{{ 'nav.compliance'|trans }}</a></li>
            <li><a href="{{ path('app_audit_log_index') }}" data-turbo-action="advance">Audit Log</a></li>
        </ul>
    </nav>

    <div class="container" data-controller="turbo">
        <div class="content">
            {% block body %}{% endblock %}
        </div>
    </div>

    <footer class="footer">
        <p>{{ 'app.footer'|trans }}</p>
        <p style="font-size: 0.9rem; margin-top: 0.5rem;">{{ 'app.powered_by'|trans({'%version%': constant('Symfony\\Component\\HttpKernel\\Kernel::VERSION')}) }}</p>
    </footer>

    {% block javascripts %}
        {% block importmap %}{{ importmap('app') }}{% endblock %}
    {% endblock %}
</body>
</html>
