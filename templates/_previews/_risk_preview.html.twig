{# Risk Quick View Preview #}
<div class="preview-content">
    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-exclamation-triangle text-warning"></i>
            {{ 'risk.preview.title'|trans({}, 'risk') }}
        </h6>
        <dl class="row mb-0">
            <dt class="col-sm-4">{{ 'risk.field.title'|trans({}, 'risk') }}:</dt>
            <dd class="col-sm-8">{{ risk.title }}</dd>

            <dt class="col-sm-4">{{ 'risk.field.status'|trans({}, 'risk') }}:</dt>
            <dd class="col-sm-8">
                <span class="badge bg-{{ risk.status == 'closed' ? 'success' : 'warning' }}">
                    {{ ('risk.modern.status.' ~ risk.status)|trans({}, 'risk') }}
                </span>
            </dd>

            {% if risk.asset %}
            <dt class="col-sm-4">{{ 'risk.field.asset'|trans({}, 'risk') }}:</dt>
            <dd class="col-sm-8">
                <a href="{{ path('app_asset_show', {id: risk.asset.id}) }}">
                    {{ risk.asset.name }}
                </a>
            </dd>
            {% endif %}

            {% if risk.riskOwner %}
            <dt class="col-sm-4">{{ 'risk.field.risk_owner'|trans({}, 'risk') }}:</dt>
            <dd class="col-sm-8">{{ risk.riskOwner }}</dd>
            {% endif %}
        </dl>
    </div>

    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-bar-chart"></i>
            {{ 'risk.section.assessment'|trans({}, 'risk') }}
        </h6>
        <div class="row g-3">
            <div class="col-6">
                <div class="risk-metric">
                    <div class="risk-metric-label">{{ 'risk.field.inherent_risk'|trans({}, 'risk') }}</div>
                    <div class="risk-metric-value text-danger">
                        {{ risk.inherentRiskLevel }}
                    </div>
                    <div class="risk-metric-detail">
                        {{ risk.probability }} × {{ risk.impact }}
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="risk-metric">
                    <div class="risk-metric-label">{{ 'risk.field.residual_risk'|trans({}, 'risk') }}</div>
                    <div class="risk-metric-value text-warning">
                        {{ risk.residualRiskLevel }}
                    </div>
                    <div class="risk-metric-detail">
                        {{ risk.residualProbability }} × {{ risk.residualImpact }}
                    </div>
                </div>
            </div>
        </div>
        {% if risk.riskReduction > 0 %}
        <div class="mt-2">
            <small class="text-success">
                <i class="bi bi-arrow-down"></i>
                {{ 'risk.field.risk_reduction'|trans({}, 'risk') }}: {{ risk.riskReduction }}%
            </small>
        </div>
        {% endif %}
    </div>

    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-file-text"></i>
            {{ 'risk.field.description'|trans({}, 'risk') }}
        </h6>
        <p class="mb-0">{{ risk.description }}</p>
    </div>

    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-shield"></i>
            {{ 'risk.section.treatment'|trans({}, 'risk') }}
        </h6>
        <div class="mb-2">
            <span class="badge bg-primary">{{ ('risk.treatment_strategy.' ~ risk.treatmentStrategy)|trans({}, 'risk') }}</span>
        </div>
        {% if risk.treatmentDescription %}
        <p class="mb-0 small text-muted">{{ risk.treatmentDescription }}</p>
        {% endif %}
    </div>

    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-graph-up"></i>
            {{ 'control.title.plural'|trans({}, 'controls') }}
        </h6>
        <div class="stat-mini">
            <div class="stat-mini-value">{{ risk.controls|length }}</div>
            <div class="stat-mini-label">{{ 'risk.field.linked_controls'|trans({}, 'risk') }}</div>
        </div>
    </div>

    <div class="preview-actions">
        <a href="{{ path('app_risk_show', {id: risk.id}) }}" class="btn btn-primary btn-sm">
            <i class="bi bi-arrow-right"></i> {{ 'common.view_details'|trans({}, 'messages') }}
        </a>
        <a href="{{ path('app_risk_edit', {id: risk.id}) }}" class="btn btn-outline-secondary btn-sm">
            <i class="bi bi-pencil"></i> {{ 'common.edit'|trans({}, 'messages') }}
        </a>
    </div>
</div>
