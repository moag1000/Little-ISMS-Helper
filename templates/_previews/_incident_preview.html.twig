{# Incident Quick View Preview #}
<div class="preview-content">
    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-exclamation-circle text-danger" aria-hidden="true"></i>
            {{ 'incident.preview.title'|trans({}, 'incident') }}
        </h6>
        <dl class="row mb-0">
            <dt class="col-sm-4">{{ 'incident.field.title'|trans({}, 'incident') }}:</dt>
            <dd class="col-sm-8">{{ incident.title }}</dd>

            <dt class="col-sm-4">{{ 'incident.field.severity'|trans({}, 'incident') }}:</dt>
            <dd class="col-sm-8">
                {% set severityClass = incident.severity == 'critical' ? 'danger' : (incident.severity == 'high' ? 'warning' : 'info') %}
                {% include '_components/_badge.html.twig' with {
                    variant: severityClass,
                    content: ('incident.severity.' ~ incident.severity)|trans({}, 'incident')
                } %}
            </dd>

            <dt class="col-sm-4">{{ 'incident.field.status'|trans({}, 'incident') }}:</dt>
            <dd class="col-sm-8">
                {% include '_components/_badge.html.twig' with {
                    variant: incident.status == 'closed' ? 'success' : 'warning',
                    content: ('incident.status.' ~ incident.status)|trans({}, 'incident')
                } %}
            </dd>

            <dt class="col-sm-4">{{ 'incident.field.detected_at'|trans({}, 'incident') }}:</dt>
            <dd class="col-sm-8">{{ incident.detectedAt|date('d.m.Y H:i') }}</dd>

            {% if incident.reportedBy %}
            <dt class="col-sm-4">{{ 'incident.field.reported_by'|trans({}, 'incident') }}:</dt>
            <dd class="col-sm-8">{{ incident.reportedBy }}</dd>
            {% endif %}
        </dl>
    </div>

    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-file-text" aria-hidden="true"></i>
            {{ 'incident.field.description'|trans({}, 'incident') }}
        </h6>
        <p class="mb-0">{{ incident.description }}</p>
    </div>

    {% if incident.affectedAssets|length > 0 %}
    <div class="preview-section">
        <h6 class="preview-section-title">
            <i class="bi bi-server" aria-hidden="true"></i>
            {{ 'incident.preview.affected_assets'|trans({'%count%': incident.affectedAssets|length}, 'incident') }}
        </h6>
        <ul class="list-unstyled mb-0">
            {% for asset in incident.affectedAssets|slice(0, 3) %}
            <li class="mb-1">
                <a href="{{ path('app_asset_show', {id: asset.id}) }}">
                    <i class="bi bi-server text-primary" aria-hidden="true"></i> {{ asset.name }}
                </a>
            </li>
            {% endfor %}
            {% if incident.affectedAssets|length > 3 %}
            <li class="text-muted small">{{ 'incident.preview.more_assets'|trans({'%count%': incident.affectedAssets|length - 3}, 'incident') }}</li>
            {% endif %}
        </ul>
    </div>
    {% endif %}

    <div class="preview-actions">
        <a href="{{ path('app_incident_show', {id: incident.id}) }}" class="btn btn-primary btn-sm">
            <i class="bi bi-arrow-right" aria-hidden="true"></i> {{ 'common.view_details'|trans({}, 'messages') }}
        </a>
        <a href="{{ path('app_incident_edit', {id: incident.id}) }}" class="btn btn-outline-secondary btn-sm">
            <i class="bi bi-pencil" aria-hidden="true"></i> {{ 'common.edit'|trans({}, 'messages') }}
        </a>
    </div>
</div>
