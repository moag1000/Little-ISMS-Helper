{# Compliance Radar Chart Component
   Usage: {% include 'analytics/_compliance_radar.html.twig' %}

   Features:
   - Spider/Radar chart for compliance visualization
   - Shows compliance % per ISO 27001 Annex
   - Overall compliance score
#}

<div class="card analytics-card radar-card {{ expanded is defined and expanded ? 'expanded' : '' }}"
     data-controller="radar-chart"
     data-radar-chart-url-value="{{ path('app_analytics_compliance_radar_data') }}">
    <div class="card-header">
        <h5 class="card-title">
            <i class="bi-diagram-3 text-success"></i>
            Compliance Radar
        </h5>
        <div class="card-actions">
            <button class="btn btn-sm btn-outline-secondary"
                    data-action="click->radar-chart#refresh"
                    title="Refresh">
                <i class="bi-arrow-clockwise"></i>
            </button>
            <button class="btn btn-sm btn-outline-secondary"
                    data-action="click->radar-chart#exportImage"
                    title="Export as PNG">
                <i class="bi-image"></i>
            </button>
        </div>
    </div>
    <div class="card-body">
        {# Loading State #}
        <div class="radar-loading d-none" data-radar-chart-target="loading">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2 text-muted">Loading compliance data...</p>
        </div>

        {# Radar Chart Container #}
        <div class="radar-container" data-radar-chart-target="container">
            {# Overall Compliance Score #}
            <div class="overall-compliance mb-3" data-radar-chart-target="overall">
                <div class="compliance-label">Overall Compliance</div>
                <div class="compliance-value" data-radar-chart-target="overallValue">
                    <span class="value">--</span>%
                </div>
            </div>

            {# Chart Canvas #}
            <canvas data-radar-chart-target="canvas"
                    width="400"
                    height="400"></canvas>

            {# Annex Details Table #}
            <div class="annex-details mt-3">
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th scope="col">Annex</th>
                            <th scope="col">Implemented</th>
                            <th scope="col">Total</th>
                            <th scope="col">Compliance</th>
                        </tr>
                    </thead>
                    <tbody data-radar-chart-target="detailsTable">
                        {# Will be populated by JavaScript #}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
