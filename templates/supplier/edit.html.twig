{% extends 'base.html.twig' %}
{% trans_default_domain 'suppliers' %}

{% block title %}{{ 'supplier.page.edit_title'|trans({'%name%': supplier.name}, 'suppliers') }}{% endblock %}

{% block body %}
<div class="container">
    {% include '_components/_breadcrumb.html.twig' with {
        breadcrumbs: [
            { label: 'nav.suppliers'|trans({}, 'nav'), url: path('app_supplier_index') },
            { label: supplier.name, url: path('app_supplier_show', {id: supplier.id}) },
            { label: 'common.edit'|trans({}, 'messages') }
        ]
    } %}

    <div class="page-header">
        <h1>{{ 'supplier.page.edit_title'|trans({'%name%': supplier.name}, 'suppliers') }}</h1>
        <div class="actions">
            <a href="{{ path('app_supplier_show', {id: supplier.id}) }}" class="btn btn-secondary">{{ 'supplier.action.view'|trans({}, 'suppliers')}}</a>
            <a href="{{ path('app_supplier_index') }}" class="btn btn-secondary">{{ 'common.back_to_list'|trans({}, 'messages') }}</a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            {{ form_start(form) }}
                {% include '_components/_auto_form.html.twig' with {
                    'form': form,
                    'sections': {
                        'details': {
                            'label': 'supplier.section.details'|trans({}, 'suppliers'),
                            'fields': ['name', 'criticality', 'status', 'description', 'serviceProvided']
                        },
                        'contact_info': {
                            'label': 'supplier.section.contact_info'|trans({}, 'suppliers'),
                            'fields': ['contactPerson', 'email', 'phone', 'address']
                        },
                        'security_assessment': {
                            'label': 'supplier.section.security_assessment'|trans({}, 'suppliers'),
                            'fields': ['securityScore', 'lastSecurityAssessment', 'nextAssessmentDate', 'assessmentFindings', 'nonConformities', 'securityRequirements']
                        },
                        'certifications_compliance': {
                            'label': 'supplier.section.certifications_compliance'|trans({}, 'suppliers'),
                            'fields': ['hasISO27001', 'hasISO22301', 'hasDPA', 'dpaSignedDate', 'certifications']
                        },
                        'contract_info': {
                            'label': 'supplier.section.contract_info'|trans({}, 'suppliers'),
                            'fields': ['contractStartDate', 'contractEndDate']
                        }
                    },
                    'col_widths': {
                        'name': 4,
                        'criticality': 4,
                        'status': 4,
                        'description': 12,
                        'serviceProvided': 12,
                        'contactPerson': 4,
                        'email': 4,
                        'phone': 4,
                        'address': 12,
                        'securityScore': 4,
                        'lastSecurityAssessment': 4,
                        'nextAssessmentDate': 4,
                        'assessmentFindings': 12,
                        'nonConformities': 12,
                        'securityRequirements': 12,
                        'hasISO27001': 12,
                        'hasISO22301': 12,
                        'hasDPA': 12,
                        'dpaSignedDate': 6,
                        'certifications': 6,
                        'contractStartDate': 6,
                        'contractEndDate': 6
                    },
                    'tooltips': {
                        'securityScore': 'supplier.tooltip.security_score',
                        'criticality': 'supplier.tooltip.criticality'
                    },
                    'translation_domain': 'suppliers'
                } %}

                <div class="d-flex justify-content-between mt-4">
                    <a href="{{ path('app_supplier_show', {id: supplier.id}) }}" class="btn btn-secondary">
                        {{ 'common.cancel'|trans({}, 'messages') }}
                    </a>
                    <button type="submit" class="btn btn-primary">
                        {{ 'supplier.action.update'|trans({}, 'suppliers')}}
                    </button>
                </div>
            {{ form_end(form) }}
        </div>
    </div>
</div>
{% endblock %}
