{% extends 'base.html.twig' %}
{% trans_default_domain 'people' %}

{% block title %}{{ person.fullName }} - {{ 'person.title.show'|trans({}, 'messages') }} - Little ISMS Helper{% endblock %}

{% block body %}
<div class="container">
    {% include '_components/_breadcrumb.html.twig' with {
        breadcrumbs: [
            { label: 'nav.people'|trans({}, 'nav'), url: path('app_person_index') },
            { label: person.fullName }
        ]
    } %}
</div>

<div class="page-header">
    <div>
        <h1>{{ person.fullName }}</h1>
        <div class="mt-2">
            {% set typeColors = {
                'employee': 'success',
                'contractor': 'info',
                'visitor': 'warning',
                'vendor': 'info',
                'auditor': 'danger',
                'consultant': 'info'
            } %}
            <span class="badge bg-{{ typeColors[person.personType] ?? 'secondary' }}">
                {{ ('person.type.' ~ person.personType)|trans({}, 'people') }}
            </span>
            {% if person.badgeId %}
                <code class="ml-sm">{{ person.badgeId }}</code>
            {% endif %}
        </div>
    </div>
    <div class="button-group">
        <a href="{{ path('app_person_edit', {id: person.id}) }}" class="btn btn-primary">
            <i class="bi bi-pencil" aria-hidden="true"></i> {{ 'common.edit'|trans({}, 'messages') }}
        </a>
        <a href="{{ path('app_person_index') }}" class="btn btn-secondary">
            ‚Üê {{ 'common.back_to_list'|trans({}, 'messages') }}
        </a>
    </div>
</div>

{# Person Details #}
{% embed '_components/_card.html.twig' with {class: 'mb-4'} %}
    {% block card_header %}
        <div class="card-header">
            <h2>{{ 'person.section.details'|trans({}, 'messages') }}</h2>
        </div>
    {% endblock %}
    {% block card_body %}
        <div class="stats-grid grid-responsive-250">
            <div class="stat-item">
                <strong>{{ person.fullName }}</strong>
                <span>{{ 'person.field.name'|trans({}, 'messages') }}</span>
            </div>

            <div class="stat-item">
                <strong>{{ ('person.type.' ~ person.personType)|trans({}, 'people') }}</strong>
                <span>{{ 'person.field.type'|trans({}, 'messages') }}</span>
            </div>

            {% if person.badgeId %}
            <div class="stat-item">
                <strong><code>{{ person.badgeId }}</code></strong>
                <span>{{ 'person.field.badge_id'|trans({}, 'messages') }}</span>
            </div>
            {% endif %}

            {% if person.company %}
            <div class="stat-item">
                <strong>{{ person.company }}</strong>
                <span>{{ 'person.field.company'|trans({}, 'messages') }}</span>
            </div>
            {% endif %}

            {% if person.department %}
            <div class="stat-item">
                <strong>{{ person.department }}</strong>
                <span>{{ 'person.field.department'|trans({}, 'messages') }}</span>
            </div>
            {% endif %}

            {% if person.jobTitle %}
            <div class="stat-item">
                <strong>{{ person.jobTitle }}</strong>
                <span>{{ 'person.field.job_title'|trans({}, 'messages') }}</span>
            </div>
            {% endif %}
        </div>
    {% endblock %}
{% endembed %}

{# Contact Information #}
{% embed '_components/_card.html.twig' with {class: 'mb-4'} %}
    {% block card_header %}
        <div class="card-header">
            <h2>{{ 'person.section.contact'|trans({}, 'messages') }}</h2>
        </div>
    {% endblock %}
    {% block card_body %}
        <div class="stats-grid grid-responsive-250">
            <div class="stat-item">
                <strong>
                    {% if person.email %}
                        <a href="mailto:{{ person.email }}">{{ person.email }}</a>
                    {% else %}
                        <span class="text-muted-color">-</span>
                    {% endif %}
                </strong>
                <span>{{ 'person.field.email'|trans({}, 'messages') }}</span>
            </div>

            <div class="stat-item">
                <strong>
                    {% if person.phone %}
                        <a href="tel:{{ person.phone }}">{{ person.phone }}</a>
                    {% else %}
                        <span class="text-muted-color">-</span>
                    {% endif %}
                </strong>
                <span>{{ 'person.field.phone'|trans({}, 'messages') }}</span>
            </div>
        </div>
    {% endblock %}
{% endembed %}

{# Additional Information #}
{% if person.notes %}
{% embed '_components/_card.html.twig' with {class: 'mb-4'} %}
    {% block card_header %}
        <div class="card-header">
            <h2>{{ 'person.section.notes'|trans({}, 'messages') }}</h2>
        </div>
    {% endblock %}
    {% block card_body %}
        <div class="info-box bg-light">
            <p class="pre-wrap">{{ person.notes }}</p>
        </div>
    {% endblock %}
{% endembed %}
{% endif %}

{# Action Buttons #}
<div class="button-group mt-xl">
    <a href="{{ path('app_person_edit', {id: person.id}) }}" class="btn btn-primary">
        <i class="bi bi-pencil" aria-hidden="true"></i> {{ 'common.edit'|trans({}, 'messages') }}
    </a>
    <a href="{{ path('app_person_index') }}" class="btn btn-secondary">
        <i class="bi bi-list" aria-hidden="true"></i> {{ 'common.back_to_list'|trans({}, 'messages') }}
    </a>
    <form method="post" action="{{ path('app_person_delete', {id: person.id}) }}" class="d-inline"
          data-controller="ui-actions"
          data-action="submit->ui-actions#confirm"
          data-ui-actions-message-param="{{ 'person.confirm.delete'|trans({}, 'messages') }}">
        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ person.id) }}">
        <button type="submit" class="btn btn-danger"><i class="bi bi-trash" aria-hidden="true"></i> {{ 'common.delete'|trans({}, 'messages') }}</button>
    </form>
</div>
{% endblock %}
